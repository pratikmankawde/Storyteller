{
  "project": "Dramebaz",
  "category": "Voice Management & Customization",
  "description": "Advanced voice selection and customization features from NovelReaderWeb",
  "version": "1.0",
  "last_updated": "2026-02-03",
  "instructions_source": "NovelReaderWeb source code analysis",
  "reference_project": "C:\\Users\\Pratik\\source\\NovelReaderWeb",
  "reference_files": [
    "src/components/voice-selector/voice-selector.component.ts",
    "src/services/tts.service.ts"
  ],
  "total_estimated_hours": 10,
  "milestones": [
    {
      "id": "VOICE-M1",
      "name": "Voice Selector UI",
      "description": "Character voice customization dialog",
      "done": false,
      "task_ids": ["VOICE-001"]
    },
    {
      "id": "VOICE-M2",
      "name": "Voice Consistency & Health",
      "description": "Voice availability checks and warnings",
      "done": false,
      "task_ids": ["VOICE-002"]
    }
  ],
  "tasks": [
    {
      "id": "VOICE-001",
      "feature": "Voice Selector Dialog",
      "description": "Dialog to customize voice for each character with filters and tuning",
      "done": false,
      "status": "not_started",
      "priority": "HIGH",
      "estimated_hours": 6,
      "reference_docs": [
        "NovelReaderWeb/src/components/voice-selector/voice-selector.component.ts"
      ],
      "files_to_modify": [
        "app/src/main/java/com/dramebaz/app/ui/reader/VoiceSelectorDialog.kt (new)",
        "app/src/main/res/layout/dialog_voice_selector.xml (new)"
      ],
      "implementation_notes": "Dialog with: Character info header, gender filter buttons (All/Female/Male), voice list, pitch/rate/volume sliders, test button, save button.",
      "work_items": [
        "Create VoiceSelectorDialog extending DialogFragment",
        "Display character info (name, gender, role) in header",
        "Add gender filter buttons (All, Female-sounding, Male-sounding)",
        "Implement voice list with selection highlighting",
        "Add pitch slider (0.5-2.0)",
        "Add rate slider (0.5-2.0)",
        "Add volume slider (0.1-1.0)",
        "Add test button with preview text",
        "Save voice settings to character profile"
      ],
      "source_code_reference": "// From NovelReaderWeb voice-selector.component.ts\nfilteredVoices = computed(() => {\n  const filter = this.filterGender();\n  const femaleKeywords = ['female', 'samantha', 'zira', 'susan'];\n  return all.filter(v => {\n    const name = v.name.toLowerCase();\n    if (filter === 'female') return femaleKeywords.some(k => name.includes(k));\n    return true;\n  });\n});\n\nplayPreview(text: string) {\n  this.tts.previewVoice({ voice: v, pitch: this.pitch(), rate: this.rate() }, text);\n}"
    },
    {
      "id": "VOICE-002",
      "feature": "Voice Consistency Check",
      "description": "Check if assigned voices are still available and warn user",
      "done": false,
      "status": "not_started",
      "priority": "MEDIUM",
      "estimated_hours": 4,
      "reference_docs": [
        "NovelReaderWeb/src/services/tts.service.ts - checkVoiceConsistency()"
      ],
      "files_to_modify": [
        "app/src/main/java/com/dramebaz/app/playback/tts/TtsService.kt",
        "app/src/main/java/com/dramebaz/app/ui/reader/ReaderFragment.kt"
      ],
      "implementation_notes": "On book open, check if all assigned voices are available. If voice not found, show warning snackbar. Suggest re-assignment or fallback voice.",
      "work_items": [
        "Add checkVoiceConsistency() to TtsService",
        "Return list of characters with missing voices",
        "Show warning dialog/snackbar in ReaderFragment",
        "Offer 'Reassign Voices' action",
        "Implement fallback voice selection logic"
      ],
      "source_code_reference": "// From NovelReaderWeb tts.service.ts\ncheckVoiceConsistency(characters: CharacterProfile[]): string[] {\n  const availableVoices = this.getVoicesByCriteria('en');\n  const missing: string[] = [];\n  for (const char of characters) {\n    if (char.assignedVoiceName && !availableVoices.find(v => v.name === char.assignedVoiceName)) {\n      missing.push(char.name);\n    }\n  }\n  return missing;\n}"
    }
  ]
}

